% -*- TeX -*-
\Preamble{svg,pic-equation,pic-align,pic-tabular}
\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{hyperref}

\DeclareGraphicsExtensions{.svg,.png,.jpg} % change to %\DeclareGraphicsExtensions{.png,.svg,.jpg} to prefer png pix
\DeclareGraphicsRule{.png}{bmp}{.xbb}{}

% <includegraphics-sizing/>
% <graphics-svg>

% FIX: Define two-digit formatting for tex4ht (moved before document)
\makeatletter
% Define a tex4ht-compatible two-digit formatter
\def\twodigits#1{\ifnum#1<10 0\fi\number#1}
\makeatother

\makeatletter
% Configure basic image handling
\Configure{graphics*}
  {svg}
  {%
    {\Configure{Needs}{File: \Gin@base.svg}\Needs{}}%
    \Picture[\csname a:GraphicsAlt\endcsname]{\csname Gin@base\endcsname.svg
      \space style="width:\expandafter\the\csname Gin@req@width\endcsname;"
    }%
  }
\makeatother

% Add CSS for figure styling
\Css{figure.figure img {
    max-width: 90%;
    width: auto;
    height: auto;
    margin: 0 auto;
}}
\Css{.subfigure {
    display: inline-block;
    width: 48%;
    margin: 0 1%;
    vertical-align: top;
}}

% Optional: add specific styling for subfigure captions if needed
\Css{.subfigure figcaption {
    margin-top: 0.5em;
}}

% Ensure figures with subfigures are properly centered
\Css{figure.figure {
    text-align: center;
    width: 100%;
    margin: 1em auto;
  }}
% <graphics-svg/>
% <includegraphics-sizing/>

% <config-eqns>
% Styling for numbered equations
% This puts the SVG in a three element table
% where the first and last elements are of size 0.01
% so that the middle element will be centered
\Css{.equation{
    display: table;
    margin-top: 1.5em;
    margin-bottom: 1.5em;
}}
\Css{.equation td:first-child{
    text-align: center;
    vertical-align: middle;
}}
\Css{.equation td:last-child{
    text-align: right;
    vertical-align: middle;
}}

% For unnumbered equations - with the same vertical margins
\Css{.equation-star{
    display: block;
    text-align: center;
    margin-top: 1.5em;
    margin-bottom: 1.5em;
}}

% Common styling for both types
\Css{.math-display img{ /* Targets images within elements with class math-display */
    display: block;     /* Makes the image a block element */
    margin-left: auto;  /* These two margin settings together */
    margin-right: auto; /* center the image horizontally */
  }
}
  
% Simple configuration for class 'equation-star'
\Configure{equation*}                   % Configure unnumbered equations
{                                       % Beginning code
    \ifvmode\IgnorePar\fi\EndP          % Handle vertical mode and paragraph endings
    \HCode{<div class="equation-star">} % Start a div with class="equation-star"
}
{                                       % Ending code
    \HCode{</div>}                      % Close the div
  }
  % <config-eqns/>
% <20250809>: claude-sonnet-3p7: I am using make4ht to generate an html version of Paramterization.tex.  It mostly works, but the citations in the parbox at the bottom of the figure 'fig:untargetedMoments' cause line breaks in the html code (but not in the pdf).  How can I fix this?  
%\ConfigureEnv{figure}{\ifvmode\IgnorePar\fi\EndP\HCode{<div class="figure">}}{\ifvmode\Ig%norePar\fi\EndP\HCode{</div>}}{}{}
%\Css{.figure .citation {display: inline;}}
%\Css{.figure .parbox {display: block; margin-top: 0.5em;}}
% </20250809>

\begin{document}

% Apply date configuration with our custom formatter
% \Configure{date}{}{\the\year-\twodigits{\month}-\twodigits{\day}}       % ISO date - COMMENTED OUT: was causing spurious output in HTML head

% Override tex4ht's built-in meta date tag to prevent spurious output in HTML head
% The system html4.4ht includes: {\HCode{<meta name="date" content="\:today"\xml:empty>\Hnewline}}
% This causes raw date text to appear in HTML head, so we override it with empty content
\Configure{META}{}{}

\EndPreamble
